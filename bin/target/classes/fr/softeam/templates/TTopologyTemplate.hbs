
{{!-- Template: TTopologyTemplate.hbs
     Notes: cleaned stray fence markers and added null-safe partial invocation guards.
--}}

{{#unless (noStereotypeApplications this "Metadata")}}metadata:{{/unless}}
{{#each ownedAttribute}}
  {{#extension}}{{#eq name "Metadata"}}
    {{../name}}: "{{../value}}"
  {{/eq}}{{/extension}}
{{/each}}
{{imports this}}

topology_template:

{{#unless (noStereotypeApplications this "InputParametersType")}}
  inputs:
  {{#ownedElement}}{{#extension}}{{#eq name "InputParametersType"}}
    {{#ownedAttribute}}{{#with this as |parameter|}}{{#extension}}{{#eq name "TParameter"}}
      {{> TParameter parameter}}
    {{/eq}}{{/extension}}{{/with}}{{/ownedAttribute}}
  {{/eq}}{{/extension}}{{/ownedElement}}
{{/unless}}

{{#unless (noStereotypeApplications this "TNodeTemplate")}}
  node_templates:
  {{#ownedElement}}{{#with this as |nodeTemplate|}}{{#extension}}{{#eq name "TNodeTemplate"}}
    {{> TNodeTemplate nodeTemplate}}
  {{/eq}}{{/extension}}{{/with}}{{/ownedElement}}
{{/unless}}

{{#unless (noStereotypeApplications this "TGroup")}}
  groups:
  {{#ownedElement}}{{#with this as |group|}}{{#extension}}{{#eq name "TGroup"}}
    {{> TGroup group}}
  {{/eq}}{{/extension}}{{/with}}{{/ownedElement}}
{{/unless}}

{{#unless (noStereotypeApplications this "TRelationshipTemplateEnd")}}
  relationship_templates:
  {{#ownedElement}}{{#targetingEnd}}{{#association}}{{#extension}}{{#eq name "TRelationshipTemplate"}}
    {{../name}}:
      type: {{getProperty ../this "type"}}
  {{/eq}}{{/extension}}{{/association}}{{/targetingEnd}}{{/ownedElement}}
{{/unless}}

{{#unless (noStereotypeApplications this "PoliciesType")}}
  policies:
  {{#ownedElement}}{{#extension}}{{#eq name "PoliciesType"}}
    {{#ownedElement}}{{#with this as |policy|}}{{#extension}}{{#eq name "TPolicy"}}
      {{> TPolicy policy}}
    {{/eq}}{{/extension}}{{/with}}{{/ownedElement}}
  {{/eq}}{{/extension}}{{/ownedElement}}

{{/unless}}
